name: OIDC Auth Example
on: [push, workflow_dispatch]

permissions:
  id-token: write  # Required to request JWT OIDC tokens
  contents: read   # Additional permissions as needed

jobs:
  auth-example:
    runs-on: ubuntu-latest
    steps:
      - name: Get OIDC Token
        id: oidc
        uses: actions/github-script@v6
        with:
          script: |
            const token = await core.getIDToken()
            core.setOutput('token', token)

      - name: Call Backend API with OIDC Token
        run: |
          curl -X POST https://your-backend.example.com/api \
            -H "Authorization: Bearer ${{ steps.oidc.outputs.token }}" \
            -H "Content-Type: application/json" \
            -d '{"repo": "${{ github.repository }}"}'
